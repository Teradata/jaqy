Jaqy Console 1.2.0
-- 0/0 - 0 ----------------------------------------------------------------
--------------------------------------------------------------------------
-- excel export / import test
--------------------------------------------------------------------------
.run ../common/postgresql_setup.sql
-- Running script: ../common/postgresql_setup.sql
-- 0/1 - 0 ----------------------------------------------------------------
.open -u postgres postgresql://localhost/?stringtype=unspecified
-- 0/2 - 0 ----------------------------------------------------------------

CREATE TABLE MyTable(a INTEGER, b DATE, c TIME, d TIMESTAMP, e BOOL, f REAL);
-- success. update count = 0
-- 1/2 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (1, '2001-01-01', '01:02:03', '2001-01-01 01:02:03', false, 1.0);
-- success. update count = 1
-- 2/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (2, '2001-01-02', null, '2001-02-01 01:02:03', true, 2.0);
-- success. update count = 1
-- 3/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (3, '2001-01-03', '03:02:03', '2001-03-01 01:02:03', null, 3.0);
-- success. update count = 1
-- 4/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (4, null, '04:02:03', '2001-04-01 01:02:03', true, null);
-- success. update count = 1
-- 5/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (5, '2001-01-05', '05:02:03', null, false, 5.0);
-- success. update count = 1
-- 6/2 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (6, '2001-01-06', '06:02:03', '2001-06-01 01:02:03', false, 6.0);
-- success. update count = 1
-- 7/2 - 0 ----------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a b          c        d                   e    f
- ---------- -------- ------------------- - ----
1 2001-01-01 01:02:03 2001-01-01 01:02:03 f    1
2 2001-01-02 ?        2001-02-01 01:02:03 t    2
3 2001-01-03 03:02:03 2001-03-01 01:02:03 ?    3
4 ?          04:02:03 2001-04-01 01:02:03 t    ?
5 2001-01-05 05:02:03 ?                   f    5
6 2001-01-06 06:02:03 2001-06-01 01:02:03 f    6
-- activity count = 6
-- 8/2 - 0 ----------------------------------------------------------------

.export excel file_io_2.xlsx
-- 8/3 - 0 ----------------------------------------------------------------
SELECT * FROM MyTable ORDER BY a;
-- success --
-- activity count = 6
-- 9/3 - 0 ----------------------------------------------------------------

DELETE FROM MyTable;
-- success. update count = 6
-- 10/3 - 0 ---------------------------------------------------------------

.import excel -h file_io_2.xlsx
-- 10/4 - 0 ---------------------------------------------------------------
INSERT INTO MyTable VALUES (?, ?, ?, ?, ?, ?);
-- 11/4 - 0 ---------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a b          c        d                   e    f
- ---------- -------- ------------------- - ----
1 2001-01-01 01:02:03 2001-01-01 01:02:03 f    1
2 2001-01-02 ?        2001-02-01 01:02:03 t    2
3 2001-01-03 03:02:03 2001-03-01 01:02:03 ?    3
4 ?          04:02:03 2001-04-01 01:02:03 t    ?
5 2001-01-05 05:02:03 ?                   f    5
6 2001-01-06 06:02:03 2001-06-01 01:02:03 f    6
-- activity count = 6
-- 12/4 - 0 ---------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 13/4 - 0 ---------------------------------------------------------------

.import excel -h file_io_2.xlsx
-- 13/5 - 0 ---------------------------------------------------------------
.importtable MyTable
-- Table Schema --
CREATE TABLE MyTable
(
	"a" int4,
	"b" numeric(6,1),
	"c" numeric(17,12),
	"d" numeric(16,11),
	"e" int4,
	"f" numeric(2,1)
)
-- success. update count = 0
-- INSERTION --
INSERT INTO MyTable VALUES (?,?,?,?,?,?)
-- 15/6 - 0 ---------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a       b                  c                 d    e    f
- ------- ------------------ ----------------- ---- ----
1 36892.0 25569.043090277777 36892.04309027778    0  1.0
2 36893.0                  ? 36923.04309027778    1  2.0
3 36894.0 25569.126423611113 36951.04309027778    ?  3.0
4       ? 25569.168090277777 36982.04309027778    1    ?
5 36896.0 25569.209756944445                 ?    0  5.0
6 36897.0 25569.251423611113 37043.04309027778    0  6.0
-- activity count = 6
-- 16/6 - 0 ---------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 17/6 - 0 ---------------------------------------------------------------

.import excel -h -d1 -t2 -s3 file_io_2.xlsx
-- 17/7 - 0 ---------------------------------------------------------------
.importtable MyTable
-- Table Schema --
CREATE TABLE MyTable
(
	"a" int4,
	"b" date,
	"c" time,
	"d" timestamp,
	"e" int4,
	"f" numeric(2,1)
)
-- success. update count = 0
-- INSERTION --
INSERT INTO MyTable VALUES (?,?,?,?,?,?)
-- 19/8 - 0 ---------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a b          c        d                      e    f
- ---------- -------- ------------------- ---- ----
1 2001-01-01 01:02:03 2001-01-01 01:02:03    0  1.0
2 2001-01-02 ?        2001-02-01 01:02:03    1  2.0
3 2001-01-03 03:02:03 2001-03-01 01:02:03    ?  3.0
4 ?          04:02:03 2001-04-01 01:02:03    1    ?
5 2001-01-05 05:02:03 ?                      0  5.0
6 2001-01-06 06:02:03 2001-06-01 01:02:03    0  6.0
-- activity count = 6
-- 20/8 - 0 ---------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 21/8 - 0 ---------------------------------------------------------------

.os rm -f file_io_2.xlsx
-- 21/9 - 0 ---------------------------------------------------------------

