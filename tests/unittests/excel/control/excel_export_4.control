Jaqy Console 1.2.0
-- 0/0 - 0 ----------------------------------------------------------------
--------------------------------------------------------------------------
-- .export excel test
--------------------------------------------------------------------------
.run ../common/postgresql_setup.sql
-- Running script: ../common/postgresql_setup.sql
-- 0/1 - 0 ----------------------------------------------------------------
.open -u postgres postgresql://localhost/?stringtype=unspecified
-- 0/2 - 0 ----------------------------------------------------------------

CREATE TABLE MyTable(a INTEGER, b DECIMAL, c DECIMAL(9,2), d DECIMAL(9,5));
-- success. update count = 0
-- 1/2 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (1, 1.15, 2.25, 333.33);
-- success. update count = 1
-- 2/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (2, 2.20, 2.30, 333.34000);
-- success. update count = 1
-- 3/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (3, 3.35, 2.45, 333.35);
-- success. update count = 1
-- 4/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (4, 4.45, 2.55, 333.36);
-- success. update count = 1
-- 5/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (5, 5.55, 2.65, 333.37);
-- success. update count = 1
-- 6/2 - 0 ----------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a    b    c         d
- ---- ---- ---------
1 1.15 2.25 333.33000
2 2.20 2.30 333.34000
3 3.35 2.45 333.35000
4 4.45 2.55 333.36000
5 5.55 2.65 333.37000
-- activity count = 5
-- 7/2 - 0 ----------------------------------------------------------------

.export excel file4.xlsx
-- 7/3 - 0 ----------------------------------------------------------------
SELECT * FROM MyTable ORDER BY a;
-- success --
-- activity count = 5
-- 8/3 - 0 ----------------------------------------------------------------

.os ${SCRIPTDIR}/cmpexcel.sh data/file4.xlsx file4.xlsx && rm -f file4.xlsx
-- 8/4 - 0 ----------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 9/4 - 0 ----------------------------------------------------------------

