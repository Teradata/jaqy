Jaqy Console 1.2.0
-- 0/0 - 0 ----------------------------------------------------------------
--------------------------------------------------------------------------
-- excel export / import test
--------------------------------------------------------------------------
.run ../common/postgresql_setup.sql
-- Running script: ../common/postgresql_setup.sql
-- 0/1 - 0 ----------------------------------------------------------------
.open -u postgres postgresql://localhost/?stringtype=unspecified
-- 0/2 - 0 ----------------------------------------------------------------

CREATE TABLE MyTable(a INTEGER, b DECIMAL, c DECIMAL(9,2), d DECIMAL(9,5));
-- success. update count = 0
-- 1/2 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (1, 1.15, 2.25, 333.33);
-- success. update count = 1
-- 2/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (2, 2.20, 2.30, 333.34000);
-- success. update count = 1
-- 3/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (3, 3.35, 2.45, 333.35);
-- success. update count = 1
-- 4/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (4, 4.45, 2.55, 333.36);
-- success. update count = 1
-- 5/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (5, 5.55, 2.65, 333.37);
-- success. update count = 1
-- 6/2 - 0 ----------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a    b    c         d
- ---- ---- ---------
1 1.15 2.25 333.33000
2 2.20 2.30 333.34000
3 3.35 2.45 333.35000
4 4.45 2.55 333.36000
5 5.55 2.65 333.37000
-- activity count = 5
-- 7/2 - 0 ----------------------------------------------------------------

.export excel file_io_1.xlsx
-- 7/3 - 0 ----------------------------------------------------------------
SELECT * FROM MyTable ORDER BY a;
-- success --
-- activity count = 5
-- 8/3 - 0 ----------------------------------------------------------------

DELETE FROM MyTable;
-- success. update count = 5
-- 9/3 - 0 ----------------------------------------------------------------

.import excel -h file_io_1.xlsx
-- 9/4 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (?, ?, ?, ?);
-- 10/4 - 0 ---------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a    b    c         d
- ---- ---- ---------
1 1.15 2.25 333.33000
2 2.20 2.30 333.34000
3 3.35 2.45 333.35000
4 4.45 2.55 333.36000
5 5.55 2.65 333.37000
-- activity count = 5
-- 11/4 - 0 ---------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 12/4 - 0 ---------------------------------------------------------------

.import excel -h file_io_1.xlsx
-- 12/5 - 0 ---------------------------------------------------------------
.importtable MyTable
-- Table Schema --
CREATE TABLE MyTable
(
	"a" int4,
	"b" numeric(3,2),
	"c" numeric(3,2),
	"d" numeric(8,5)
)
-- success. update count = 0
-- INSERTION --
INSERT INTO MyTable VALUES (?,?,?,?)
-- 14/6 - 0 ---------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a    b    c         d
- ---- ---- ---------
1 1.15 2.25 333.33000
2 2.20 2.30 333.34000
3 3.35 2.45 333.35000
4 4.45 2.55 333.36000
5 5.55 2.65 333.37000
-- activity count = 5
-- 15/6 - 0 ---------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 16/6 - 0 ---------------------------------------------------------------

.os rm -f file_io_1.xlsx
-- 16/7 - 0 ---------------------------------------------------------------

