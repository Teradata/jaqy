Jaqy Console 1.2.0
-- 0/0 - 0 ----------------------------------------------------------------
--------------------------------------------------------------------------
-- .export excel test
--------------------------------------------------------------------------
.run ../common/postgresql_setup.sql
-- Running script: ../common/postgresql_setup.sql
-- 0/1 - 0 ----------------------------------------------------------------
.open -u postgres postgresql://localhost/?stringtype=unspecified
-- 0/2 - 0 ----------------------------------------------------------------

CREATE TABLE MyTable(a INTEGER, b DATE, c TIME, d TIMESTAMP, e BOOL, f REAL);
-- success. update count = 0
-- 1/2 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (1, '2001-01-01', '01:02:03', '2001-01-01 01:02:03', false, 1.0);
-- success. update count = 1
-- 2/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (2, '2001-01-02', null, '2001-02-01 01:02:03', true, 2.0);
-- success. update count = 1
-- 3/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (3, '2001-01-03', '03:02:03', '2001-03-01 01:02:03', null, 3.0);
-- success. update count = 1
-- 4/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (4, null, '04:02:03', '2001-04-01 01:02:03', true, null);
-- success. update count = 1
-- 5/2 - 0 ----------------------------------------------------------------
INSERT INTO MyTable VALUES (5, '2001-01-05', '05:02:03', null, false, 5.0);
-- success. update count = 1
-- 6/2 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (6, '2001-01-06', '06:02:03', '2001-06-01 01:02:03', false, 6.0);
-- success. update count = 1
-- 7/2 - 0 ----------------------------------------------------------------

SELECT * FROM MyTable ORDER BY a;
-- success --
a b          c        d                   e    f
- ---------- -------- ------------------- - ----
1 2001-01-01 01:02:03 2001-01-01 01:02:03 f    1
2 2001-01-02 ?        2001-02-01 01:02:03 t    2
3 2001-01-03 03:02:03 2001-03-01 01:02:03 ?    3
4 ?          04:02:03 2001-04-01 01:02:03 t    ?
5 2001-01-05 05:02:03 ?                   f    5
6 2001-01-06 06:02:03 2001-06-01 01:02:03 f    6
-- activity count = 6
-- 8/2 - 0 ----------------------------------------------------------------

.export excel -n MyTable -h file3.xlsx
-- 8/3 - 0 ----------------------------------------------------------------
SELECT * FROM MyTable ORDER BY a;
-- success --
-- activity count = 6
-- 9/3 - 0 ----------------------------------------------------------------

.os ${SCRIPTDIR}/cmpexcel.sh data/file3.xlsx file3.xlsx && rm -f file3.xlsx
-- 9/4 - 0 ----------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 10/4 - 0 ---------------------------------------------------------------

