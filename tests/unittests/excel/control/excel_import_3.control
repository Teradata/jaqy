Jaqy Console 1.2.0
-- 0/0 - 0 ----------------------------------------------------------------
--------------------------------------------------------------------------
-- .import excel test
--------------------------------------------------------------------------
.run ../common/sqlite_setup.sql
-- Running script: ../common/sqlite_setup.sql
-- 0/1 - 0 ----------------------------------------------------------------
.open sqlite::memory:
-- 0/2 - 0 ----------------------------------------------------------------

.import excel data/empty.xlsx
-- error: Missing data in the sheet.
-- 0/3 - 0 ----------------------------------------------------------------
.importtable -c MyTable
-- error: There is no current import.
-- 0/4 - 0 ----------------------------------------------------------------
DROP TABLE MyTable;
-- failure 1: [SQLITE_ERROR] SQL error or missing database (no such table: MyTable)
-- 1/4 - 0 ----------------------------------------------------------------

.import excel -h data/badheader.xlsx
-- error: Empty header column: 2
-- 1/5 - 0 ----------------------------------------------------------------
.importtable -c MyTable
-- error: There is no current import.
-- 1/6 - 0 ----------------------------------------------------------------
DROP TABLE MyTable;
-- failure 1: [SQLITE_ERROR] SQL error or missing database (no such table: MyTable)
-- 2/6 - 0 ----------------------------------------------------------------

.import excel -h data/nofirstcol.xlsx
-- error: Empty header column: 0
-- 2/7 - 0 ----------------------------------------------------------------
.importtable -c MyTable
-- error: There is no current import.
-- 2/8 - 0 ----------------------------------------------------------------
DROP TABLE MyTable;
-- failure 1: [SQLITE_ERROR] SQL error or missing database (no such table: MyTable)
-- 3/8 - 0 ----------------------------------------------------------------

.import excel data/nofirstrow.xlsx
-- 3/9 - 0 ----------------------------------------------------------------
.importtable -c MyTable
-- Table Schema --
CREATE TABLE MyTable
(
	"col1" INTEGER NOT NULL,
	"col2" TEXT NOT NULL,
	"col3" TEXT NOT NULL
)
-- success. update count = 0
-- INSERTION --
INSERT INTO MyTable VALUES (?,?,?)
-- success. update count = 1
-- 5/10 - 0 ---------------------------------------------------------------
DROP TABLE MyTable;
-- success. update count = 1
-- 6/10 - 0 ---------------------------------------------------------------

