Jaqy Console 1.0.1
-- 0/0 - 0 ----------------------------------------------------------------
--------------------------------------------------------------------------
-- .repeat command test
--------------------------------------------------------------------------
.help limit
usage: .limit [number]
-- 0/1 - 0 ----------------------------------------------------------------
.limit
-- error: Current session is closed.
-- 0/2 - 0 ----------------------------------------------------------------
.limit 5
-- error: Current session is closed.
-- 0/3 - 0 ----------------------------------------------------------------
.limit asdf
-- error: Current session is closed.
-- 0/4 - 0 ----------------------------------------------------------------

.run ../common/postgresql_setup.sql
-- Running script: ../common/postgresql_setup.sql
-- 0/5 - 0 ----------------------------------------------------------------
.open -u postgres postgresql://localhost/?stringtype=unspecified
-- 0/6 - 0 ----------------------------------------------------------------

CREATE TABLE MyTable (a INTEGER, b VARCHAR(10000));
-- success. update count = 0
-- 1/6 - 0 ----------------------------------------------------------------

INSERT INTO MyTable VALUES (1, 'POINT(1 1)');
-- success. update count = 1
-- 2/6 - 0 ----------------------------------------------------------------

.repeat 5
-- 2/7 - 0 ----------------------------------------------------------------
INSERT INTO MyTable
SELECT a + (SELECT MAX(a) FROM MyTable),
       'POINT(' || (a + (SELECT MAX(a) FROM MyTable)) || ' ' || (a + (SELECT MAX(a) FROM MyTable)) || ')'
FROM MyTable;
-- iteration: 1
-- success. update count = 1
-- iteration: 2
-- success. update count = 2
-- iteration: 3
-- success. update count = 4
-- iteration: 4
-- success. update count = 8
-- iteration: 5
-- success. update count = 16
-- 3/7 - 0 ----------------------------------------------------------------

.limit asdf
-- error: invalid limit number.
-- 3/8 - 0 ----------------------------------------------------------------
.limit
.limit 0
-- 3/9 - 0 ----------------------------------------------------------------
.limit -1234
-- 3/10 - 0 ---------------------------------------------------------------
.limit
.limit -1234
-- 3/11 - 0 ---------------------------------------------------------------
.limit 1
-- 3/12 - 0 ---------------------------------------------------------------
.limit
.limit 1
-- 3/13 - 0 ---------------------------------------------------------------
SELECT * FROM MyTable ORDER BY a;
-- success --
a b
- ----------
1 POINT(1 1)
-- activity count = 1
-- 4/13 - 0 ---------------------------------------------------------------

.limit 2
-- 4/14 - 0 ---------------------------------------------------------------
SELECT * FROM MyTable ORDER BY a;
-- success --
a b
- ----------
1 POINT(1 1)
2 POINT(2 2)
-- activity count = 2
-- 5/14 - 0 ---------------------------------------------------------------

.limit 12
-- 5/15 - 0 ---------------------------------------------------------------
SELECT * FROM MyTable ORDER BY b;
-- success --
 a b
-- ------------
10 POINT(10 10)
 1 POINT(1 1)
11 POINT(11 11)
12 POINT(12 12)
13 POINT(13 13)
14 POINT(14 14)
15 POINT(15 15)
16 POINT(16 16)
17 POINT(17 17)
18 POINT(18 18)
19 POINT(19 19)
20 POINT(20 20)
-- activity count = 12
-- 6/15 - 0 ---------------------------------------------------------------

.limit 12
-- 6/16 - 0 ---------------------------------------------------------------
.sort 1 desc
-- 6/17 - 0 ---------------------------------------------------------------
SELECT * FROM MyTable ORDER BY b;
-- success --
 a b
-- ------------
20 POINT(20 20)
19 POINT(19 19)
18 POINT(18 18)
17 POINT(17 17)
16 POINT(16 16)
15 POINT(15 15)
14 POINT(14 14)
13 POINT(13 13)
12 POINT(12 12)
11 POINT(11 11)
10 POINT(10 10)
 1 POINT(1 1)
-- activity count = 12
-- 7/17 - 0 ---------------------------------------------------------------

DROP TABLE MyTable;
-- success. update count = 0
-- 8/17 - 0 ---------------------------------------------------------------

.close
-- 8/18 - 0 ---------------------------------------------------------------
